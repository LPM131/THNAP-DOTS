/* chat-ui.css - full-screen cylinder + chat screen styling */
:root {
  --bg: #0d0d0f;
  --panel: rgba(255,255,255,0.06);
  --accent: #4cffb7;
  --text: #ffffff;
  --muted: #bfbfbf;
  --radius: 14px;
}

/* Full-screen host */
.chat-root {
  position: fixed;
  inset: 0;
  background: var(--bg);
  -webkit-backface-visibility: hidden;
  backface-visibility: hidden;
  display: flex;
  flex-direction: column;
  z-index: 10000;
  color: var(--text);
  overflow: hidden;
  will-change: transform, opacity;
}

/* Header with back button */
.chat-header {
  height: 56px;
  display: flex;
  align-items: center;
  padding: 0 12px;
  gap: 12px;
  flex-shrink: 0;
  background: linear-gradient(180deg, rgba(255,255,255,0.02), transparent);
  border-bottom: 1px solid rgba(255,255,255,0.03);
}
.chat-back-btn {
  background: none;
  border: none;
  color: var(--text);
  font-size: 18px;
  padding: 8px;
  border-radius: 8px;
  cursor: pointer;
}
.chat-title {
  font-weight: 700;
  font-size: 18px;
}

/* Cylinder area: occupies full remaining height */
.chat-body {
  display: flex;
  flex: 1 1 auto;
  align-items: center;
  justify-content: center;
  position: relative;
  perspective: 1400px;
}

/* Cylinder shell */
.cylinder-shell {
  width: 92vw;
  max-width: 420px;
  height: calc(var(--vh, 1vh) * 100 - 110px); /* header + safe margin */
  max-height: 720px;
  transform-style: preserve-3d;
  position: relative;
}

/* Cylinder surface */
#cylinder {
  position: absolute;
  inset: 0;
  transform-style: preserve-3d;
  pointer-events: auto;
}

/* Thread card */
.thread {
  position: absolute;
  top: 50%;
  left: 50%;
  width: 86%;
  max-width: 360px;
  height: 72px;
  margin-left: -43%;
  margin-top: -36px;
  background: var(--panel);
  border-radius: 16px;
  backdrop-filter: blur(6px);
  display: flex;
  align-items: center;
  padding: 12px 14px;
  gap: 12px;
  transform-style: preserve-3d;
  cursor: grab;
  transition: transform 220ms cubic-bezier(.2,.9,.2,1), opacity 160ms ease, filter 160ms ease;
  box-shadow: 0 4px 18px rgba(0,0,0,0.45), inset 0 1px 0 rgba(255,255,255,0.02);
}
.thread:active { cursor: grabbing; }

/* Dot avatar */
.thread .dot {
  width: 56px;
  height: 56px;
  border-radius: 999px;
  flex-shrink: 0;
  box-shadow: 0 6px 20px rgba(0,0,0,0.5), 0 0 18px var(--accent);
  display: flex;
  align-items: center;
  justify-content: center;
  color: #0b0b0b;
  font-weight: 700;
}

/* Meta */
.thread .meta { display:flex; flex-direction:column; overflow:hidden; }
.thread .name { font-weight:700; font-size:1rem; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }
.thread .preview { font-size:.88rem; color:var(--muted); white-space:nowrap; overflow:hidden; text-overflow:ellipsis; margin-top:4px; }

/* Active styling */
.thread.active {
  transform: translateZ(36px) scale(1.06);
  background: rgba(255,255,255,0.12);
}

/* Sonar + bounce animation (kept) */
.sonar { position:absolute; width:56px; height:56px; border-radius:999px; pointer-events:none; border:2px solid var(--accent); transform:translate(-50%,-50%); left:50%; top:50%; animation:sonar 1.2s ease-out forwards; }
@keyframes sonar { 0%{transform:translate(-50%,-50%) scale(.6);opacity:.6}50%{transform:translate(-50%,-50%) scale(1.4);opacity:.2}100%{transform:translate(-50%,-50%) scale(.6);opacity:0} }

/* Chat-screen wrapper (hidden until open) */
.chat-screen {
  position: absolute;
  inset: 0;
  background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
  z-index: 15000;
  display: flex;
  flex-direction: column;
  transform-origin: top center;
  -webkit-overflow-scrolling: touch;
}

/* chat header inside chat-screen */
.chat-screen .top {
  height: 60px;
  display:flex;
  align-items:center;
  gap:10px;
  padding: 0 12px;
  border-bottom: 1px solid rgba(255,255,255,0.03);
}

/* messages area */
.chat-messages {
  flex:1;
  overflow:auto;
  padding: 18px;
  display:flex;
  flex-direction:column;
  gap:12px;
}

/* bubble */
.bubble {
  display:inline-block;
  padding: 10px 14px;
  border-radius: 18px;
  max-width: 78%;
  line-height:1.3;
  font-size: 15px;
  box-shadow: 0 6px 18px rgba(0,0,0,0.35);
  word-wrap: break-word;
  white-space: pre-wrap;
}

/* you vs other */
.msg.you .bubble { background:#DCF8C6; align-self:flex-end; color:#000; border-bottom-right-radius: 6px; }
.msg.other .bubble { background: rgba(255,255,255,0.08); color: #fff; border-bottom-left-radius: 6px; align-self:flex-start; }

/* input */
.chat-input {
  display:flex;
  gap:8px;
  padding: 10px;
  align-items:center;
  border-top:1px solid rgba(255,255,255,0.03);
}
.chat-input input {
  flex:1;
  padding: 12px 14px;
  border-radius: 18px;
  border: none;
  background: rgba(255,255,255,0.04);
  color: var(--text);
  outline: none;
}

/* responsive tweaks */
@media (max-width:520px) {
  .thread { height:64px; }
  .thread .dot { width:48px;height:48px; }
  .thread .name { font-size:.98rem; }
  .cylinder-shell { width: 94vw; height: calc(var(--vh,1vh)*100 - 110px); }
}
